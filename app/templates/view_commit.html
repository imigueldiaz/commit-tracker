{% extends "base.html" %}

{% block title %}View Commit{% endblock %}

{% block content %}
<div class="card mb-4">
    <div class="card-header">
        <h5 class="card-title mb-0">{{ commit.commit_number }}</h5>
    </div>
    <div class="card-body">
        <h6 class="card-subtitle mb-2 text-muted">Branch: {{ commit.branch }}</h6>
        <p class="card-text">{{ commit.commit_message }}</p>

        {% if commit.long_comment %}
        <div class="card mb-3">
            <div class="card-header">
                Comment
            </div>
            <div class="card-body">
                {{ html_content|safe }}
            </div>
        </div>
        {% endif %}

        {% if commit.attachments %}
        <div class="card mb-3">
            <div class="card-header">
                Attachments
            </div>
            <div class="card-body">
                <ul class="list-group">
                {% for attachment in commit.attachments %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ attachment.filename }}
                        <div>
                            <a href="{{ url_for('main.download_attachment', id=attachment.id) }}"
                               class="btn btn-sm btn-primary">Download</a>
                            <a href="{{ url_for('main.delete_attachment', id=attachment.id) }}"
                               class="btn btn-sm btn-danger"
                               onclick="return confirm('Are you sure you want to delete this attachment?')">Delete</a>
                        </div>
                    </li>
                {% endfor %}
                </ul>
            </div>
        </div>
        {% endif %}

        <p class="text-muted">Created on {{ commit.created_at.strftime('%Y-%m-%d %H:%M') }}</p>
    </div>
    <div class="card-footer">
        <a href="{{ url_for('main.edit_commit', id=commit.id) }}" class="btn btn-warning">Edit</a>
        <a href="{{ url_for('main.delete_commit', id=commit.id) }}"
           class="btn btn-danger"
           onclick="return confirm('Are you sure you want to delete this commit?')">Delete</a>
        <a href="{{ url_for('main.index') }}" class="btn btn-secondary">Back to List</a>
    </div>
</div>
{% endblock %}